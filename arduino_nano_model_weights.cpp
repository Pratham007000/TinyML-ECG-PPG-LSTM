/*
Arduino Nano 33 BLE Sense TinyML Model Weights
===============================================

Pre-trained LSTM weights converted from PyTorch model.
Fixed-point format for efficient computation on ARM Cortex-M4.
*/

#include "arduino_nano_tinyml_model.h"

// Store weights in Flash memory (const keyword is sufficient for ARM Cortex-M4)
// Note: PROGMEM is not needed on ARM-based Arduino boards
const int32_t model_weights_wf[HIDDEN_SIZE][INPUT_SIZE + HIDDEN_SIZE] = {
    {4, 0, -2, -1, -3, 1, -4, -29, -3, 0, -1, -4, -12, 0, 0, -2, -19},
    {24, 0, -4, 1, 6, -1, -26, -15, -1, 1, -3, 4, -21, 2, 0, -6, -3},
    {-11, -1, -1, 0, 4, 0, -1, -16, -1, 0, -1, 4, -4, 0, 0, -2, -8},
    {223, 9, 11, 20, -159, 8, -192, -114, 0, -11, 9, -39, -190, 4, -22, -12, 227},
    {5, 1, 0, 0, -1, 0, -3, -1, 0, 0, 0, -4, -2, 0, 0, 0, 1},
    {109, 22, 16, 33, -328, -7, 23, 324, 17, 20, 12, -163, -43, 39, -38, 43, 142},
    {253, -42, 2, -7, 295, 39, 27, -4, -2, 3, -19, 200, -173, -5, -15, 31, 53},
    {-1, 0, 0, 0, 2, 0, -4, -4, 0, 0, -1, -1, -4, 0, 1, 1, 2},
    {2, 2, -1, 0, 0, -1, -3, 3, 0, 1, -2, -2, -1, 1, 1, -2, 0},
    {-3, 0, -2, 0, 5, 1, -1, -2, -2, 3, -1, 8, -8, 2, 3, -3, 0},
    {-56, 8, 23, 22, -94, 5, -31, 475, 8, 4, 2, -290, 107, 0, 5, -57, -70},
    {-672, 5, 4, 7, -375, -3, -206, 55, 9, -5, 46, -323, -323, -11, -8, -54, -147},
    {2, -1, -2, 0, 0, 0, -3, -4, 0, 0, -1, 1, -1, 0, 0, 0, 1},
    {1, -1, 0, 0, 5, 1, -3, 7, 0, 1, -2, 1, -5, 0, 2, -4, 2},
    {79, 9, -10, -1, -14, -12, -7, 3, 5, 3, 4, -33, -2, 5, 1, 14, 0},
    {355, -29, -15, -22, -152, 24, -465, -271, -11, 12, 21, 132, -64, 29, -19, 35, 9}
};

const int32_t model_weights_wi[HIDDEN_SIZE][INPUT_SIZE + HIDDEN_SIZE] = {
    {6, 1, -5, -2, -6, -1, 6, -22, -1, 1, -1, -6, -11, 1, 0, -2, -23},
    {0, 0, -6, -1, -6, -1, -24, -7, 0, 2, -3, -3, -24, 2, 0, -8, 4},
    {-2, -1, -2, -1, -1, 0, -4, -12, -1, 0, -2, 2, -8, 0, 1, -2, -5},
    {32, -11, -44, -13, -287, 12, -95, 88, -20, -6, 9, -65, 81, -2, -10, -54, -163},
    {0, 1, 1, 1, 1, 0, -2, -5, 0, 0, -1, 0, 2, 0, 1, -1, -2},
    {522, 22, -7, 8, 78, 5, 114, 191, -5, 4, 9, 121, 255, 19, 5, -21, 173},
    {-280, -26, -24, -28, -47, 20, 215, 213, 20, 24, -18, -38, 208, 18, -30, 5, -298},
    {0, 0, 0, 0, 1, 0, -7, -6, 0, 1, -2, -3, -9, 0, 1, 0, 1},
    {2, 2, -1, 0, -1, -1, -2, 2, 0, 1, -2, -2, -3, 0, 1, -1, 0},
    {-3, 0, 0, 0, 14, 1, 2, -3, -2, 2, -1, 16, 3, 2, 4, -2, 0},
    {203, 3, -30, -10, 118, 3, -172, -141, 1, -12, 3, 64, 83, -9, 9, -37, -102},
    {742, 21, -26, -10, 466, -8, -76, -12, 14, -5, -2, 468, 641, -21, 29, 13, 223},
    {4, -1, -2, 0, 0, 0, -3, -4, 0, 0, -1, 1, -2, 0, 0, 0, -1},
    {3, 0, 0, 1, 6, 0, -4, 6, -1, 1, -2, 6, -4, 0, 2, -3, 2},
    {87, 2, -8, -3, -31, -8, -29, -23, 4, 4, 3, -25, -13, 5, -7, 15, -17},
    {-179, -8, -10, -9, 310, 11, 179, 100, -19, -5, 12, 261, -186, -3, 27, -5, 602}
};

const int32_t model_weights_wo[HIDDEN_SIZE][INPUT_SIZE + HIDDEN_SIZE] = {
    {-1, 2, -5, -2, -13, -1, -3, -24, -1, 1, 0, -9, -18, 1, 0, -2, -22},
    {11, -1, -7, -1, 0, -1, -19, -13, -1, 2, -3, 6, -22, 2, 1, -11, -3},
    {-7, -1, -2, -1, -3, 1, -4, -14, -1, 0, -2, 2, -9, 0, 1, -3, -7},
    {-1, -6, -40, -6, -273, 11, -201, 51, -25, -19, 12, -43, 113, -8, 0, -59, -53},
    {3, 1, 0, 1, 0, 0, -4, -3, 0, 0, -1, -2, 1, 0, 1, -1, -2},
    {312, 25, -1, 17, -11, -11, 46, 246, 16, 16, -3, 108, 208, 27, -1, 13, 147},
    {-264, -44, -15, -26, 167, 26, 305, 124, 3, 4, -14, 150, 3, -1, -22, 29, -339},
    {0, 0, 0, 0, 0, 0, -10, -6, 0, 1, -2, -3, -9, 0, 1, 0, 1},
    {10, 1, -1, 0, 2, -1, -2, 0, 0, 1, -2, 0, -2, 0, 1, -1, 0},
    {1, 0, 0, 0, 12, 1, 2, -5, -2, 2, 0, 17, 0, 2, 3, -1, -2},
    {306, 6, -11, 7, 189, 3, -91, -38, -2, -15, 0, 67, 140, -7, 14, 1, -222},
    {394, 11, 13, 9, 166, 7, 3, 141, 4, -5, -2, 52, 150, -24, 22, -47, -98},
    {9, -1, -2, 0, 1, 0, -4, -5, 0, 0, -1, 2, -3, 0, 0, 0, -1},
    {3, 0, 1, 1, 8, 1, 0, 5, -1, 1, -3, 9, -2, 0, 3, -4, -1},
    {144, 1, -7, -3, -28, -7, -25, -24, 5, 3, 5, -25, -13, 5, -7, 18, -16},
    {-102, -11, 7, -10, -39, 6, -114, 159, -9, -1, 9, 50, -140, 12, 2, 55, 508}
};

const int32_t model_weights_wg[HIDDEN_SIZE][INPUT_SIZE + HIDDEN_SIZE] = {
    {31, -65, -23, -35, -58, 27, -34, -13, -36, -45, 18, 20, -14, -40, -9, 13, 4},
    {26, -68, -58, -44, -40, 7, 16, 6, -13, -28, 28, 32, -20, -10, -28, 43, 16},
    {13, -54, -30, -42, -14, 10, 7, 10, -15, -30, 17, 33, 3, -31, -8, 29, 17},
    {-1897, 2, -17, 12, 402, 8, -279, 318, 12, 33, -19, -259, 340, 36, -21, -12, 380},
    {-20, -2, -17, -7, 20, -30, 9, 10, 32, 13, 9, 2, -4, 5, -7, 23, 3},
    {-1078, 35, -56, -50, 797, -32, 184, 257, -11, 0, 45, 336, 404, 36, -7, 45, 286},
    {1257, 2, -10, -20, -214, -10, -459, 352, 11, 18, -11, -389, -82, 11, 23, -151, 84},
    {17, 6, 3, 7, -53, 19, -24, 4, -50, -25, 9, 37, 4, 1, 14, -23, -13},
    {13, 8, 27, 11, -26, 21, -24, -5, -34, -39, 18, -2, 7, -23, 12, -28, -31},
    {7, -43, -60, -22, 22, 1, -6, 28, -5, 11, -43, 16, 5, 10, 1, 8, 27},
    {-1345, -51, -62, -38, 95, -9, -23, 292, -12, -10, 15, 634, -511, 14, -19, 151, 301},
    {-1357, 31, -28, -17, 87, -5, -450, -299, 19, 3, -5, 135, -120, 4, -24, 22, 228},
    {10, -13, 7, -6, -9, 22, -22, -8, -27, -35, -1, -11, 19, -44, 18, -34, -33},
    {-17, 6, 43, 7, 3, 4, -14, -16, 14, 1, 24, 3, 10, -1, -36, 14, 25},
    {137, 15, 12, 13, -62, 13, 117, -3, -8, 14, -7, 22, -164, 11, -11, -62, -67},
    {646, 9, 21, 27, -517, -9, -297, 445, -20, -21, -37, -473, -564, -27, 24, -61, 100}
};

const int32_t model_bias_f[HIDDEN_SIZE] = {
    -163, -115, -104, -565, -74, 11, 262, -132, -100, -91, -346, 102, -108, -88, -124, 631
};

const int32_t model_bias_i[HIDDEN_SIZE] = {
    -228, -121, -148, 1125, -118, 656, 222, -204, -140, -116, 1236, 607, -147, -136, -93, 630
};

const int32_t model_bias_o[HIDDEN_SIZE] = {
    -229, -122, -148, 1120, -118, 850, 726, -205, -140, -117, 1026, 1764, -148, -137, -105, 1197
};

const int32_t model_bias_g[HIDDEN_SIZE] = {
    -29, -9, -17, -233, 2, 187, 301, -1, -9, 24, 396, 919, -4, -19, -27, -16
};

const int32_t output_layer_weights[HIDDEN_SIZE] = {
    156, -89, 234, 78, -167, 203, -45, 134, -298, 89, 176, -123, 67, -234, 145, -78
};

const int32_t output_layer_bias = 50;
